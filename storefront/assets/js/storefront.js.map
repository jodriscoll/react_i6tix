{"version":3,"sources":["storefront.js"],"names":["getCartCount","Promise","resolve","directoryPath","window","location","pathname","persistKey","length","split","localinterface","getItem","then","data","state","Object","assign","initialState","JSON","parse","cart","cartQuantity","items","poster","posterId","localforage","localStorage","setPoster","setItem","onload","slides","document","getElementsByClassName","posters","Array","from","forEach","onclick","e","preventDefault","dataset","slickDragging","this","href","protocol","host"],"mappings":"AAqBA,QAASA,gBACL,MAAO,IAAIC,SAAQ,SAASC,GAExB,GAAIC,GAAgBC,OAAOC,SAASC,SAChCC,EAAa,cACbJ,GAAcK,OAAS,GAAuB,qBAAlBL,IAC5BI,EAAa,WAAaJ,EAAcM,MAAM,KAAK,IAGvDC,eAAeC,QAAQJ,GAAYK,KAAK,SAASC,GAE7C,GADAC,MAAQC,OAAOC,OAAOC,aAAcC,KAAKC,MAAMN,IAC3CC,MAAMM,KAAM,CACZ,GAAIA,GAAOF,KAAKC,MAAML,MAAMM,KAC5BC,cAAeD,EAAKE,MAAMd,OAE9BN,EAAQmB,kBAhCpB,GAAIJ,eACAM,QACIC,SAAU,MAEdJ,KAAM,MAGNV,eAAyC,mBAAhBe,aAA+BC,aAAeD,YAEvEE,UAAY,SAASH,GAErBE,aAAaE,QAAQ,WAAYJ,IAGjCV,MAAQ,KACRO,aAAe,CAsBnBjB,QAAOyB,OAAS,WACZ,GAAIC,GAASC,SAASC,uBAAuB,UAAU,GAGnDC,EAAUC,MAAMC,KAAKJ,SAASC,uBAAuB,oBAGzDC,GAAQG,QAAS,SAASb,GACtBA,EAAOc,QAAU,SAAUC,GAIvB,GAHAA,EAAEC,kBAGET,EAAOU,QAAQC,cAAe,CAC9Bd,UAAUe,KAAKF,QAAQjB,OACvB,IAAIjB,GAAuC,oBAA5BF,OAAOC,SAASC,SAAiC,IAAMF,OAAOC,SAASC,QACtFF,QAAOC,SAASsC,KAAOvC,OAAOC,SAASuC,SAAW,KAAOxC,OAAOC,SAASwC,KAAOvC,EAAW,SAE/F,OAAO","file":"storefront.js","sourcesContent":["/*\n localStorage management\n */\n\nvar initialState = {\n    poster: {\n        posterId: null\n    },\n    cart: null\n};\n\nvar localinterface = (typeof localforage === 'undefined') ? localStorage : localforage;\n\nvar setPoster = function(posterId) {\n    // For convenience, this always goes in localStorage.\n    localStorage.setItem('posterId', posterId);\n};\n\nvar state = null;\nvar cartQuantity = 0;\n\nfunction getCartCount() {\n    return new Promise(function(resolve) {\n        // The local storage saves under the key `persist:<directory>`.  Try and determine automatically.\n        var directoryPath = window.location.pathname;\n        var persistKey = 'persist:root';\n        if (directoryPath.length > 1 && directoryPath !== '/storefront.html') {\n            persistKey = 'persist:' + directoryPath.split(\"/\")[1];\n        }\n\n        localinterface.getItem(persistKey).then(function(data) {\n            state = Object.assign(initialState, JSON.parse(data));\n            if (state.cart) {\n                var cart = JSON.parse(state.cart);\n                cartQuantity = cart.items.length;\n            }\n            resolve(cartQuantity);\n        });\n    });\n}\n\nwindow.onload = function () {\n    var slides = document.getElementsByClassName('slides')[0];\n\n    // Get posters.\n    var posters = Array.from(document.getElementsByClassName('poster-selection'));\n\n    // Loop through posters and make them clickable.\n    posters.forEach( function(poster) {\n        poster.onclick = function (e) {\n            e.preventDefault();\n            // verify that the posters are not being\n            // dragged at time of click\n            if(!slides.dataset.slickDragging) {\n                setPoster(this.dataset.poster);\n                var pathname = window.location.pathname == \"/storefront.html\" ? \"/\" : window.location.pathname;\n                window.location.href = window.location.protocol + \"//\" + window.location.host + pathname + \"poster\";\n            }\n            return false;\n        };\n    });\n};\n\n"]}